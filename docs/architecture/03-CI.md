# CI

KeyRGB uses GitHub Actions to run fast checks on pushes and pull requests.

## What CI runs

The CI workflow runs the build runner:

```bash
python3 -m buildpython --profile=ci
```

This includes:
- `compileall`
- import validation
- `pip check`
- import scan
- `pytest`

Hardware tests are skipped by default.

In addition, CI builds the AppImage as a separate job:

```bash
python3 -m buildpython --profile=ci --with-appimage
```

The resulting artifact is uploaded as a workflow artifact named `keyrgb-x86_64.AppImage`.

## Hardware tests

Hardware-dependent tests are opt-in via:

- `KEYRGB_HW_TESTS=1`

This keeps CI deterministic and avoids failures on runners without the device.

## How this relates to `buildpython`

If CI starts failing, reproduce locally using the same command and inspect the step logs in `buildlog/keyrgb/`.

## Release automation

On tags matching `v*`, GitHub Actions builds the AppImage and uploads it to the corresponding GitHub Release.

- Workflow: `.github/workflows/release.yml`
- Tag example:

```bash
git tag v1.2.3
git push origin v1.2.3
```
